//
// Created by 10044 on 2024/3/2.
// 使用移位的方式拼接成一个个31位的S，从低位开始对齐
// k 8位 d 7位（从低位开始对齐）iv有8位有6位（6位低位对齐）
//

#include "key_insert.h"
void Key_IV_Insert(uint8* const k, uint8* const iv, uint32* const LFSR)
{
    //S组成方式1
    LFSR[0]=(k[0]<<23)|(d[0]<<16)|(k[21]<<8)|(k[16]);
    LFSR[1]=(k[1]<<23)|(d[1]<<16)|(k[22]<<8)|(k[17]);
    LFSR[2]=(k[2]<<23)|(d[2]<<16)|(k[23]<<8)|(k[18]);
    LFSR[3]=(k[3]<<23)|(d[3]<<16)|(k[24]<<8)|(k[19]);
    LFSR[4]=(k[4]<<23)|(d[4]<<16)|(k[25]<<8)|(k[20]);
    //S组成方式2
    LFSR[5]=(iv[0]<<23)|((d[5]|iv[17])<<16)|(k[5]<<8)|(k[26]);
    LFSR[6]=(iv[1]<<23)|((d[6]|iv[18])<<16)|(k[6]<<8)|(k[27]);
    //S组成方式3
    LFSR[7]=(iv[10]<<23)|((d[7]|iv[19])<<16)|(k[7]<<8)|(iv[2]);
    //S组成方式4
    LFSR[8]=(k[8]<<23)|((d[8]|iv[20])<<16)|(iv[3]<<8)|(iv[11]);
    LFSR[9]=(k[9]<<23)|((d[9]|iv[20])<<16)|(iv[12]<<8)|(iv[4]);
    //S组成方式2
    LFSR[10]=(iv[5]<<23)|((d[10]|iv[22])<<16)|(k[10]<<8)|(k[28]);
    //S组成方式4
    LFSR[11]=(k[11]<<23)|((d[11]|iv[23])<<16)|(iv[6]<<8)|(iv[13]);
    LFSR[12]=(k[12]<<23)|((d[12]|iv[24])<<16)|(iv[7]<<8)|(iv[14]);
    //S组成方式5
    LFSR[13]=(k[13]<<23)|(d[13]<<16)|(iv[15]<<8)|(iv[8]);
    //S组成方式6
    LFSR[14]=(k[14]<<23)|((d[14]|(k[31]>>4))<<16)|(iv[16]<<8)|(iv[9]);
    LFSR[15]=(k[15]<<23)|((d[15]|(k[31] & 0xf))<<16)|(iv[16]<<8)|(iv[9]);

}